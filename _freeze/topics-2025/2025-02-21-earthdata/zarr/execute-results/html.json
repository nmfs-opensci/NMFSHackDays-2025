{
  "hash": "6583e61ae57790a21a7e39ccdbc0d4b1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Zarr\nauthor: Eli Holmes\n---\n\n\n\n::: {.callout-note title=\"Learning Objectives\"}\n1.  How to access a Zarr collection in R\n:::\n\n## Summary\n\nIn this example, we will get single files from a Zarr collection.\n\n## Reading in a `Zarr` file\n\nReading in collection in `Zarr` format is easy in Python:\n```\nds = xarray.open_zarr(\"https://mur-sst.s3.us-west-2.amazonaws.com/zarr-v1\")\n```\nHowever we can open individual files from a `Zarr` file.\n\nRead one file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://mur-sst.s3.us-west-2.amazonaws.com/zarr-v1\"\nprefixes <- 'ZARR:\\\"/vsicurl/'\nslice <- '\\\":/analysed_sst:0\"'\naddr <- paste0(prefixes, url, slice)\ny = terra::rast(addr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by /srv/conda/envs/notebook/lib/gdalplugins/gdal_PDF.so) (GDAL\nerror 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by /srv/conda/envs/notebook/lib/gdalplugins/gdal_PDF.so) (GDAL\nerror 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libtiledb.so.2.27) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libtiledb.so.2.27) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libarrow.so.1801) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libarrow.so.1801) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libparquet.so.1801) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libparquet.so.1801) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by /srv/conda/envs/notebook/lib/gdalplugins/gdal_PDF.so) (GDAL\nerror 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by /srv/conda/envs/notebook/lib/gdalplugins/gdal_PDF.so) (GDAL\nerror 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libtiledb.so.2.27) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.31' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libtiledb.so.2.27) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libarrow.so.1801) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libarrow.so.1801) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libparquet.so.1801) (GDAL error 1)\nWarning: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not\nfound (required by\n/srv/conda/envs/notebook/lib/gdalplugins/../libparquet.so.1801) (GDAL error 1)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\nWarning: /srv/conda/envs/notebook/lib/gdalplugins/.././libtiff.so.6: undefined\nsymbol: jpeg12_write_raw_data, version LIBJPEG_8.0 (GDAL error 1)\n```\n\n\n:::\n:::\n\n\n\nPlot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne <- terra::ext(c(xmin=-75.5, xmax=-73.5,  ymin=33.5, ymax=35.5 ))\ny |> terra::crop(e) |> terra::plot()\n```\n\n::: {.cell-output-display}\n![](zarr_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\nRead multiple files.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvrt <- function(i) {\n  prefix <-  'ZARR:\\\"/vsicurl/'\n  url <- \"https://mur-sst.s3.us-west-2.amazonaws.com/zarr-v1\"\n  slice <- paste0('\\\":/analysed_sst:',i,'\"')\n  paste0(prefix, url, slice)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- terra::rast(vrt(0:3))\ne <- terra::ext(c(xmin=-75.5, xmax=-73.5,  ymin=33.5, ymax=35.5 ))\ny |> terra::crop(e) |> terra::plot()\n```\n\n::: {.cell-output-display}\n![](zarr_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "zarr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}